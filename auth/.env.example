# ── Server ─────────────────────────────────────────────
PORT=3000
NODE_ENV=development                     # 'development' | 'production'

# ── NeonDB (pooled pgbouncer connection string) ───────
DATABASE_URL=postgres://user:pass@ep-xxx.us-east-1.aws.neon.tech/eisenauth?sslmode=require

# ── CORS ──────────────────────────────────────────────
ALLOWED_ORIGINS=http://localhost:5173    # comma-separated origins

# ── JWT ───────────────────────────────────────────────
JWT_SECRET=                              # openssl rand -hex 32 (min 32 chars)
JWT_EXPIRES_IN=86400                     # seconds — 24h
JWT_OFFLINE_WINDOW=604800                # seconds — 7 days

# ── OAuth: Google ─────────────────────────────────────
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_REDIRECT_URI=http://localhost:3000/auth/google/callback

# ── OAuth: GitHub ─────────────────────────────────────
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=
GITHUB_REDIRECT_URI=http://localhost:3000/auth/github/callback

# ── Post-OAuth redirect (frontend dashboard URL) ──────
FRONTEND_URL=http://localhost:5173

# ── Master key (dev: raw hex, prod: replaced by GCP KMS)
MASTER_KEY=                              # openssl rand -hex 32 (64 hex chars = 32 bytes)

# ── GCP KMS (production only) ─────────────────────────
# GCP_PROJECT_ID=
# GCP_KMS_LOCATION=global
# GCP_KMS_KEY_RING=eisen-auth
# GCP_KMS_KEY_NAME=master-key
# MASTER_KEY_CIPHERTEXT=                  # base64-encoded KMS ciphertext of the 32-byte master key
# GOOGLE_APPLICATION_CREDENTIALS handled by Cloud Run service account

# ── Stripe ────────────────────────────────────────────
STRIPE_SECRET_KEY=sk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...
STRIPE_PRO_PRICE_ID=price_...
STRIPE_PREMIUM_PRICE_ID=price_...
PUBLIC_URL=http://localhost:3000         # used for Stripe success/cancel redirects

# ── Admin ─────────────────────────────────────────────
ADMIN_SECRET=                            # guards /admin/* routes
